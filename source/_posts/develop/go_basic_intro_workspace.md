---
title: Go语言入门总结：工作空间
date: 2018-07-10 16:41:10
updated: 2018-07-10 16:41:10
categories:
- 网页开发

tags:
- Go
---
# 前言
梳理总结学习Go语言的笔记，关于Go中工作空间的理解以及设置，以及关于`go`命令行相关工具的介绍。

<!-- more -->
# 工作空间结构
go语言的工作空间其实就是一个文件目录，目录中必须包含src、pkg、bin三个目录。
- src目录用于存放go项目源代码
- pkg目录用于package对象
- bin目录用于存放可执行对象。

使用go的编译命令工具可以将源代码或package编译后的二进制输出对应存储到bin（目标文件）和pkg（库文件）目录中。

```shell
go install # compile source code
go build && go install # compile after build a new package
```

## 源码文件
- 命令源码文件：程序的入口，必须是main包且有且只有一个`func main()`函数。
- 包/库源码文件：一般用于集中放置各种待被使用的程序实体（全局常量、全局变量、接口、结构体、函数等等）
- 测试源码文件：为了测试上面两种源码文件，文件名以`_test.go`为后缀，包内函数以`func TestXXX`或`func ExampleXXX`或`func BenchmarkXXX`开头。

# GOPATH环境变量
GOPATH环境变量支持多个值，如果你有多个工作空间，可以把多个工作空间值都添加到这个环境变量中，window系统使用分号`;`分隔不同值，Linux或Unix系统使用冒号`:`分隔不同值。**请不要将GOROOT目录添加到GOPATH**。
而为了方便开发，还需要将`$(GOPATH)/bin`加入系统变量`PATH`中。

## 小结
GOPATH下的src目录就是接下来开发程序的主要目录，所有的源码都是放在这个目录下面，应该使用源码托管的方式进行对项目代码的组织管理。即`src/github.com/user_name/repo_name`下为对应工程目录。一般的做法就是一个目录一个项目；**文件夹名称一般是代码包名称**。值得注意的是这种方式不支持gitlab。

# Go命令
## 常用Go命令

|命令|说明|常用参数|
|:---:|---|---|
|`go build`|编译源码文件或代码包以及它们的依赖包，生成可执行文件|`-v`：打印构建过程涉及的包包名<br>`-o`：指定可执行文件名<br>`-i`：安装那些构建过程中需要安装但还未被安装的包<br>`-race`：开启竞态条件的检测<br>`-work`：打印出编译时生成的临时工作目录的路径，编译结束时会删除该目录|
|`go install`|相较`go build`，将编译好后的可执行文件移动到指定目录<br>库源码文件编译为与平台相关的.a静态链接库文件|`-a`：强行重新安装指定代码包以及它们的依赖包|
|`go get`|根据要求和实际情况从互联网上下载或更新指定的代码包及其依赖包，并对它们进行编译和安装|`-u`：让命令利用网络来更新已有代码包及其依赖包。<br>`-d`：让命令程序只执行下载动作，而不执行安装动作；<br>`-x`：打印出用到的命令|
|`go run`|编译并运行**命令源码文件**|接受所有可用于`go build`命令的标记|
|`go test`|以代码包为单位的测试|`-v`：打印测试过程中的输出<br>`-run=`：指定单元测试内容<br>`-c`：生成用于运行测试的可执行文件，但不执行它|

## 其它Go命令
```sh
go list     # 列出指定的代码包的信息
go env      # 打印Go语言的环境信息
go doc      # 打印附于Go语言程序实体上的文档
godoc       # 用于展示指定代码包的文档；如：godoc -http=:6060

go clean    # 删除掉执行其它命令时产生的一些文件和目录
go fix      # 把指定代码包的所有Go语言源码文件中的旧版本代码修正为新版本的代码
go tool fix

go vet      # 用于检查Go语言源码中静态错误的简单工具
go tool vet

go tool pprof
go tool cgo
```

# 资料链接
- 郝林：[GO 命令教程](https://www.kancloud.cn/cattong/go_command_tutorial/261360)

# Changelog
- 2019/06/25：修正格式，添加关于源码文件部分的内容，由于更新无关紧要，所以不更新博文的日期